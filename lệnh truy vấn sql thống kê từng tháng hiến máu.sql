use	BoodDonationApp
select row_number() over(order by v.idVisit) as indexVisit, p.namePerson, p.yobPerson,p.create_time,P.emailPerson,p.cmndPerson,p.cccdPerson, p.phonePerson, v.idVisit, v.idBatch, t.codeBagBlood, t.quantityBlood,d.nameDonation, t.volumeBlood,t.rh ,d.locationDonation,CONCAT(N'Tổ', p.nestHome, N'Số ', p.numberHome, N'Đường', p.streetHome, N'Phường', w.nameWard, N'Quận', dt.nameDistrict, N'Thành Phố', city.nameCity) AS Diachi,t.rh,p.idPerson,cb.nameBlood, case v.statusVisit when 0 then N'Đăng ký' when 1 then N'Tham gia' when 2 then N'Đã hiến' end as statusVisit,  case p.sexPerson when 0 then N'Nam' when 1 then N'Nữ'  end as sex from tb_Person p inner join tb_Visit v on p.idPerson = v.idPerson left join tb_Take t on t.idVisit = v.idVisit INNER JOIN tb_Donation d on v.idBatch = d.idDonation INNER JOIN tb_Category_City city on city.idCity = p.idCity INNER JOIN tb_Category_District dt on dt.idDistrict = p.idDistrict INNER JOIN tb_Category_Ward w on w.idWard = p.idWard left join tb_Category_Blood cb on cb.idBlood = t.idBlood WHERE p.create_time >= '2024-06-01' AND p.create_time < '2024-06-30' 
